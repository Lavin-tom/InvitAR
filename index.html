<!DOCTYPE html>
<html>
<head>
    <title>AR-Invite</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="script/mindar-image-aframe.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@pqina/flip/dist/tick.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <script src="https://unpkg.com/aframe-html-shader@1.3.0/dist/aframe-html-shader.min.js"></script>
    <link rel="shortcut icon" type="image/png" href="assets/favicon.png">
    <script>
        const showPortfolio = (done) => {
            document.querySelector("#flip-countdown").style.display = "block";
            const portfolio = document.querySelector("#portfolio-panel");
            let y = -0.5;
            portfolio.setAttribute("visible", true);
            const id = setInterval(() => {
                y += 0.008;
                if (y >= 0) {
                    clearInterval(id);
                    setTimeout(done, 500);
                }
                portfolio.setAttribute("position", `0 ${y} -0.01`);
            }, 10);
        };
        function openContact() {
            const phoneNumber = "1234567890"; 
            const message = "Hello, I'd like to connect!"; 
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }
        function openCalendar() {
            const eventTitle = "Wedding Day";
            const eventStartDate = "20250818T113000Z";
            const eventEndDate = "20250818T220000Z";
            const eventDescription = "Join us for a wonderful Christmas Eve celebration!";
            const eventLocation = "Jerusalem Mar Thoma Syrian Church, Koothrapally";
            const googleCalendarUrl = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventTitle)}&dates=${eventStartDate}/${eventEndDate}&details=${encodeURIComponent(eventDescription)}&location=${encodeURIComponent(eventLocation)}&sf=true&output=xml`;
            window.open(googleCalendarUrl, '_blank');
        }
        function openGoogleMaps() {
            const googleMapsUrl = `https://maps.app.goo.gl/3M8UD9NZdfzCyPJd6`;
            window.open(googleMapsUrl, '_blank');
        } 
        // Countdown to Event
        //setInterval(updateCountdown, 1000);
        AFRAME.registerComponent('mytarget', {
            init: function() {
                this.el.addEventListener('targetFound', () => {
                    console.log("target found");
                    const audio = document.querySelector("#musicmp3");
                    audio.play().catch(e => console.log("Audio play failed:", e));                  

                    const emojis = ['💖', '💘', '💕', '❤️'];
                    const shape = confetti.shapeFromText({ text: emojis[Math.floor(Math.random() * emojis.length)], scalar: 2 });
                    confetti({
                    particleCount: 150,
                    spread: 150,
                    origin: { y: 0.6 },
                    shapes: [shape]
                    });
                    setTimeout(() => {
                        showPortfolio(() => {                     
                        });
                    }, 300);
                });   
                this.el.addEventListener('targetLost', () => {
                    const audio = document.querySelector("#musicmp3");
                    audio.pause();
                });
            }
        });
        function handleTickInit(tick) {
            var counter = Tick.count.down("2025-08-18T11:30:00+05:30"); // Change time zone if needed
            counter.onupdate = function (value) {
            tick.value = value;
            };
            counter.onended = function () {
            tick.root.style.display = 'none';
            document.querySelector('.tick-onended-message').style.display = '';
            };
        }        
    </script>    
    <style>
        body {
            margin: 0;
        }
        .example-container {
            overflow: hidden;
            position: absolute;
            width: 100%;
            height: 100%;
        }       
        .customText {
            font-family: 'MyCustomFont';
        }
        #countdown {
              font-family: 'Orbitron', monospace;
              font-weight: bold;
        }
        .clickable:hover {
            opacity: 0.9;
            cursor: pointer;
        }      
        #example-scanning-overlay {
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            background: transparent;
            z-index: 2;
        }
        @media (min-aspect-ratio: 1/1) {
            #example-scanning-overlay .inner {
                width: 50vh;
                height: 50vh;
            }
        }
        @media (max-aspect-ratio: 1/1) {
            #example-scanning-overlay .inner {
                width: 80vw;
                height: 80vw;
            }
        }
        #example-scanning-overlay .inner {
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background: linear-gradient(to right, white 10px, transparent 10px) 0 0,
                        linear-gradient(to right, white 10px, transparent 10px) 0 100%,
                        linear-gradient(to left, white 10px, transparent 10px) 100% 0,
                        linear-gradient(to left, white 10px, transparent 10px) 100% 100%,
                        linear-gradient(to bottom, white 10px, transparent 10px) 0 0,
                        linear-gradient(to bottom, white 10px, transparent 10px) 100% 0,
                        linear-gradient(to top, white 10px, transparent 10px) 0 100%,
                        linear-gradient(to top, white 10px, transparent 10px) 100% 100%;
            background-repeat: no-repeat;
            background-size: 40px 40px;
        }
        #example-scanning-overlay.hidden {
            display: none;
        }
        #example-scanning-overlay img {
            opacity: 0.6;    
            width: 70%;
            height: auto;
            align-self: center;
        }
        #example-scanning-overlay .inner .scanline {
            position: absolute;
            width: 100%;
            height: 10px;
            background: white;
            animation: move 2s linear infinite;
        }        
        @keyframes move {
            0%, 100% { top: 0%; }
            50% { top: calc(100% - 10px); }
        }
    </style>
</head>
<body>
    <div class="example-container">
        <div id="example-scanning-overlay" class="hidden">
            <div class="inner">
                <img src="./assets/BaseImageFullND.jpg" />
                <div class="scanline"></div>
            </div>
        </div>      
        <a-scene mindar-image="imageTargetSrc: targets.mind; showStats: false; uiScanning: #example-scanning-overlay;" embedded color-space="sRGB" renderer="colorManagement: true, physicallyCorrectLights"
            vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
            <a-assets>
                <img id="BaseImageND" src="assets/BaseImageND.jpg"/>                                 
                <audio id="musicmp3" preload="auto" src="./assets/emotional-piano-music-256262.mp3"></audio>
            </a-assets>
            <a-camera position="0 0 0" look-controls="enabled: false" cursor="fuse: false; rayOrigin: mouse;" raycaster="far: 10000; objects: .clickable"></a-camera>
            <a-entity id="mytarget" mytarget mindar-image-target="targetIndex: 0" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
                <a-entity id="portfolio-panel" position="0 -0.25 -0.01" visible="false">
                    <a-entity id="portfolio-item0">
                        <a-image id="BaseImageND" class="" src="#BaseImageND" position="0 0 0" height="0.9" width="1.4"></a-image>                                                  
                    </a-entity>
                </a-entity>
                <a-entity
                geometry="primitive: plane; width: 1.0; height: 0.3"
                material="shader: html; target: #flip-countdown"
                position="0 -0.65 0.02"
                ></a-entity>
            </a-entity>
        </a-scene>
    </div>
<div id="flip-countdown" style="display:none;">
  <style>
    .tick {
      font-size:1rem; white-space:nowrap; font-family:arial,sans-serif;
    }
    .tick-flip,.tick-text-inline {
      font-size:2.5em;
    }
    .tick-label {
      margin-top:1em;font-size:1em;
    }
    .tick-char {
      width:1.5em;
    }
    .tick-text-inline {
      display:inline-block;text-align:center;min-width:1em;
    }
    .tick-text-inline+.tick-text-inline {
      margin-left:-.325em;
    }
    .tick-group {
      margin:0 .5em;text-align:center;
    }
    .tick-text-inline {
      color: rgb(90, 93, 99) !important; 
    }
    .tick-label {
      color: rgb(90, 93, 99) !important; 
    }
    .tick-flip-panel {
      color: rgb(255, 255, 255) !important; 
    }
    .tick-flip-panel {
      background-color: rgb(59, 61, 59) !important; 
    }
    .tick-flip {
      border-radius:0.12em !important; 
    }
  </style>

<div id="flip-countdown" style="display:none;">
  <div class="tick" data-did-init="handleTickInit">
    <div data-repeat="true" data-layout="horizontal fit" data-transform="preset(d, h, m, s) -> delay">
      <div class="tick-group">
        <div data-key="value" data-repeat="true" data-transform="pad(00) -> split -> delay">
          <span data-view="flip"></span>
        </div>
        <span data-key="label" data-view="text" class="tick-label"></span>
      </div>
    </div>
  </div>
</div>
</div>
</body>
</html>
